---
title: "Desenvolvimento de Modelos em Python"
author: "Ramon Moreno Ferrari em "
date: "`r format(Sys.time(), '%d/%m/%Y')`"
output: github_document #output RMD
# Para output PDF/Latex, comentar acima e descomentar abaixo:
#
#fontfamily: lmodern #https://tug.org/FontCatalogue/seriffonts.html
#header-includes:
#  - \usepackage{graphicx}
#  - \usepackage{fancyhdr}
#  - \usepackage[T1]{fontenc}
#  - \usepackage[default]{sourcesanspro}
#  - \usepackage{lmodern}
#  - \input{preamble}  
#  - \pagestyle{mystyle}
#  - \hypersetup{pageanchor=false}
#output: 
#  pdf_document:
#    keep_tex: true
---
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(reticulate)
```

```{r,warning=FALSE,message=FALSE,include=FALSE}
library(tidyverse)
library(knitr)
library(showtext)
font_add_google(name = "Roboto Slab",family = "Roboto") # https://fonts.google.com/?sort=popularity
```

## Baixando o dado
```{python}
import pandas as pd
import numpy as np
url='https://raw.githubusercontent.com/ramonferrari/r_and_python/main/intro_python_files/imports-85.data'
df=pd.read_csv(url,header=None)
df
headers = ["symboling","normalized-losses","make","fuel-type","aspiration", "num-of-doors","body-style", "drive-wheels","engine-location","wheel-base", "length","width","height","curb-weight","engine-type", "num-of-cylinders", "engine-size","fuel-system","bore","stroke","compression-ratio","horsepower", "peak-rpm","city-mpg","highway-mpg","price"]
df.columns=headers
df["normalized-losses"]=df["normalized-losses"].replace("?",np.nan) # trocamos ? por NaN
df['normalized-losses'] = df['normalized-losses'].astype(float) # convertermos de string para float
df["price"]=df["price"].replace("?",np.nan) # trocamos ? por NaN
df['price'] = df['price'].astype(float) # convertermos de string para float
df["city-mpg"]=235/df["city-mpg"]
df.rename(columns={"city-mpg":"city-L/100km"},inplace=True)
df.dropna(axis=0,inplace=True) # mesmo acima, ja substituindo o dataset df
df
df.dtypes
```

## Regressão Linear Simples
Preditor ou variável independentes ($x$)
Target ou variável dependente ($y$), que denotaremos de $\hat{y}$ fazendo referência a um modelo.
Buscamos uma relação linear do tipo
$$\hat{y}=ax + b$$
Onde $a$ é o slope, ou coeficiente angular, e $b$ é o intercept, ou coeficiente linear. A equação cima nos permite calcular o valor de $y$ para $x$ não pertencentes ao conjunto de treinamento.

### Modelando:
```{python}
from sklearn.linear_model import LinearRegression
lm=LinearRegression() # cria um objeto de regressão linear
x=df[['highway-mpg']]
y=df[['price']]
lm.fit(x,y)
y_hat=lm.predict(x)
b=lm.intercept_
a=lm.coef_
print("O relacionamento é dado por: \nPrice = ",a,"highway-mpg + ",b)
```

## Regressão Linear Múltipla
Buscamos uma relação linear do tipo
$$ \hat{y} =a_1x_1 +a_2x_2 + a_3x_3 + \dots + b $$
```{python}
x=df[['horsepower','curb-weight','engine-size','highway-mpg']]
y=df[['price']]
lm.fit(x,y)
y_hat=lm.predict(x)
b=lm.intercept_
a=lm.coef_
print("O relacionamento é dado por: \nPrice = ",a[[0],0],"horsepower + ",a[[0],1],"curb-weight + ",a[[0],2],"engine-size + ",a[[0],3],"highway-mpg + ",b)
```