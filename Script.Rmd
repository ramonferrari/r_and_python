---
title: "Códigos em R e Python"
author: "Ramon Moreno Ferrari em "
date: "`r format(Sys.time(), '%d/%m/%Y')`"
output: github_document #output RMD
# Para output PDF/Latex, comentar acima e descomentar abaixo:
#
#fontfamily: lmodern #https://tug.org/FontCatalogue/seriffonts.html
#header-includes:
#  - \usepackage{graphicx}
#  - \usepackage{fancyhdr}
#  - \usepackage[T1]{fontenc}
#  - \usepackage[default]{sourcesanspro}
#  - \usepackage{lmodern}
#  - \input{preamble}  
#  - \pagestyle{mystyle}
#  - \hypersetup{pageanchor=false}
#output: 
#  pdf_document:
#    keep_tex: true
---
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(reticulate)
```

```{r,warning=FALSE,message=FALSE,include=FALSE}
library(tidyverse)
library(knitr)
library(showtext)
font_add_google(name = "Roboto Slab",family = "Roboto") # https://fonts.google.com/?sort=popularity
```

## O mais básico: comentando o código
Use # para comentar o código:    
```{r}
# Isso é um comentário.
```

O mesmo (#) em Python:
```{python,warning=FALSE,message=FALSE}
# Isso também é um comentário!

# Que também é obtido por 3 aspas duplas! """
# (Muito útil para comentar grandes blocos de código rapidamente)
```
## Atribuição
No R, utilize `=` ou `<-` para atribuir o valor a uma variável.

```{r cars}
df<-cars # o sinal de = também funciona!
summary(df)
```

## Impressão de textos e variáveis
Em R:
```{r}
print("oi tudo bem?")
print(df$speed)
```

## Help-me!
Em R, utilize a função help()
```{r,eval=F}
help(print)
```

O mesmo em Python:
```{python}
help(print)
```

## Including Plots

Os plots são incluídos no Rmd. No R, utilize plot() ou o package ggplot2.

```{r pressure}
plot(pressure)
```

Em Python, utilize a biblioteca matplotlib:
```{python}
import matplotlib.pyplot as plt
# %matplotlib inline se estivesse num Jupyter Notebook
plt.plot(5,5,'o')
plt.xlabel("eixo X")
plt.ylabel("eixo Y")
plt.title("exemplo de plot")
plt.show()
```

## Importar uma planilha para o Pandas
```{python}
import numpy as np # útil para computação científica em Python
import pandas as pd # pacote para estruturar data frames
from __future__ import print_function # retrocompatibilidade python2
#!pip install xlrd
#print('xlrd instalado!')
df_can = pd.read_excel('https://github.com/ramonferrari/r_and_python/blob/main/Script_files/Canada_new.xlsx?raw=true',sheet_name="Canada by Citizenship",skiprows=range(20),skipfooter=2, engine='openpyxl')
df_can.head()
#list(df_can.columns)
df_can.columns = df_can.columns.astype(str)
```

```{python}
years=list(map(str,range(1980,2014)))
years_num = list(map(int,years))
df_can['Soma']=df_can[years].sum(axis=1)
df_can.head()
df_can.loc[75,years].plot(kind='line')
plt.xlabel("Anos")
plt.ylabel("Número de imigrantes")
plt.title("Imigração a partir do Haiti")
plt.show()
```

# Sorting e Transposing um data frame
```{python}
df_can.rename(columns={"OdName":"Country"},inplace=True)
df_can=df_can.set_index('Country')
df_can.sort_values(['Soma'],ascending=False,axis=0,inplace=True)
df_can.head()
df_top5=df_can.head()
df_top5=df_top5[years].transpose()
```

# Area Plot
```{python}
df_top5.plot(kind='area')
plt.xlabel("Anos")
plt.ylabel("Número de imigrantes")
plt.title("Top 5 países em imigração")
plt.show()
```

# Histogram Plot
```{python}
import matplotlib as mpl
import matplotlib.pyplot as plt

df_can['2013'].plot(kind='hist')

plt.title("Histograma de imigração de 195 países em 2013")
plt.ylabel("Número de Paises")
plt.xlabel("Número de imigrantes")

plt.show()

import matplotlib as mpl
import matplotlib.pyplot as plt
import numpy as np 

count,bin_edges=np.histogram(df_can['2013'])

df_can['2013'].plot(kind='hist',xticks=bin_edges)

plt.title("Histograma de imigração de 195 países em 2013")
plt.ylabel("Número de Paises")
plt.xlabel("Número de imigrantes")

plt.show()
```

# Gráfico de barras
```{python}
df_iceland=df_can.loc['Iceland',years]
df_iceland.plot(kind='bar')

plt.title("Imigração Islândia -> Canada de 1980 a 2013")
plt.ylabel("Número de Imigrantes")
plt.xlabel("Ano")

plt.show()
```

## Sobre Rmd
Utilizar `echo = FALSE` no RMarkdown faz com que o código não apareça no output, apenas o resultado (um gráfico, por exemplo!).

